<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<title>AVANGO C++ Style Guide</title>
<link rel="stylesheet" type="text/css" href="screen.css" />
</head>
<body>

<!-- Start page contents -->

<h2>AVANGO C++ Style Guide</h2>

<h3>Overview</h3>

<ul>
<li><a href="#objectives">Objectives</a></li>
<li><a href="#overall">Overall</a></li>
<li><a href="#naming">Naming</a></li>
<li><a href="#coding">Coding</a></li>
<li><a href="#documentation">Documentation</a></li>
<li><a href="#header">Header</a></li>
<li><a href="#implementation">Implementation</a></li>
<li><a href="#subversion">Subversion</a></li>
<li><a href="#references">References</a></li>
</ul>

<a name="objectives"></a>
<h3>Objectives</h3>

<p>The goal of this guide is to provide standard rules for AVANGO C++
developers which help to maintain a uniform coding style. This not only
supports easier understanding but should ideally help to produce less
erroneous code. Unless there are good reasons you should really follow
the rules written down in this document.</p>

<p>We start with a general overview over source code layout and naming
issues before going into the details and providing a minimal template as
a starting point for your AVANGO modules.</p>

<a name="overall"></a>
<h3>Overall Format</h3>

<p>
<ul>
<li>Add yourself to the AUTHORS file when you change something inside a module</li>
<li>Page width is 100 chars</li>
<li>Do not use tabs for indentation</li>
<li>Indentation width is 2 spaces</li>
<li>Every file starts with a copyright header which may only be preceeded by a Mode line, e.g. <code>-*- Mode:C++ -*-</code> or a <a href="http://en.wikipedia.org/wiki/Shebang_%28Unix%29">Shebang</a>, e.g. <code>#! /bin/sh</code></li>
</ul>
</p>

<a name="naming"></a>
<h3>Naming Guidelines</h3>

<p>
<ul>
<li>File names usually correspond to the contained class (e.g. <code>Type.h</code>)</li>
<li>Type names have the format: <code>Word1Word2...</code></li>
<li>Function names have the format: <code>word1Word2...();</code></li>
<li>Function arguments have the format: <code>word1Word2...</code></li>
<li>AVANGO Fields have the format: <code>(S|M)[A]FType Word1Word2...;</code></li>
<li>Other instance members have the format: <code>mWord1Word2...</code></li>
<li>Static members have the format: <code>sWord1Word2...</code></li>
<li>Global variables have the format: <code>gWord1Word2...</code></li>
<li>Local variables and file static variables (variables in unnamed namespace) have the format <code>word1_word2...</code></li>
<li>Constants are uppercase, words separated with underscores: <code>WORD1_WORD2_...</code></li>
<li>Namespace naming Scheme: <code>av</code> for core library, <code>av::moduleName</code> for extension libraries (e.g. <code>av::osg</code>, <code>av::osgParticle</code>, <code>av::tools</code>)</li>
<li>Don't add redundant namespace information (e.g. to function parameters)</li>
<li>Include directories usually correspond to namespaces with <code>av</code> replaced with <code>avango</code>, i.e. core library headers go to <code>$prefix/include/avango</code>, <a href="http://www.openscenegraph.org">OpenSceneGraph</a> extension headers to <code>$prefix/include/avango/osg</code>. More examples: <code>$prefix/include/avango/osgParticle</code>, <code>$prefix/include/avango/tools</code></li>
</ul>
</p>

<a name="coding"></a>
<h3>Coding Guidelines</h3>

<p>
<ul>
<li>Check arguments at beginning of functions and throw an exception if you can't recover</li>
<li>Check pointer arguments for validness</li>
<li>Use C++-style casts wherever possible. If you <em>really have to</em> use C-style casts, add a comment why</li>
<li><code>TRUE</code> and <code>FALSE</code> are deprecated, use <code>bool</code> type wherever possible</li>
<li><code>NULL</code> is deprecated, use <code>0</code> instead</li>
<li>Use <code>typename</code> instead of <code>class</code> for template arguments</li>
<li>Do not declare variables at beginning of the block, but as needed</li>
<li>Don't add unnecessary spaces inside brackets. Use this style:
<pre class="snippet">
void f(int i);
template <typename T> void g();
std::set<int> s;
</pre>
</li>

<li>Initializer lists in Constructors have the following format:
<pre class="snippet">
Class::Class() :
  mMember1(),
  mMember2(),
  ...
  mMemberN()
{
  ...
}
</pre>
</li>

<li>Within function blocks, follow this style for conditionals:
<pre class="snippet">
if ()
{
  ...
}

if ()
{
  ...
}
else if ()
{
  ...
}

switch ()
{
  case1:
    break;
  default:
    break;
}
</pre>
</li>

<li>In general, break brackets apart from declarations and command lines
<pre class="snippet">
namespace av
{

  class C
  {
    ...
  public:
    ...
  };

}

void f()
{
  while (true)
  {
    doSomething();
  }
}
</pre></li>
</ul>
</p>

<a name="errorhandling"></a>
<h3>Error handling</h3>

<p>Use assertions to validate internal assumptions. Use exception to announce wrong
interface usage or to signal local error states to the user. Whenever possible try
to use std exceptions.</p>

<a name="writetests"></a>
<h3>Write tests</h3>

<p>Write self-contained tests for your modules using the AVANGO UnitTest++ infrastructure.
Link the tests against the final library instead of the separate convenience libraries
(e.g. don't use libfields.la but libavango.la). This way we don't run into trouble when
new dependencies are introduced.</p>

<a name="documentation"></a>
<h3>Documentation Guidelines</h3>

<p>
<ul>
<li>Document at least the public and protected interface using Doxygen comments in Javadoc style (see <a href="#references">references</a>).</li>
<li>Document arguments when there meaning is not obvious.</li>
<li>Document exceptions functions may throw.</li>
<li>Define groups for your extension library and document your extensions library namespace (see Avango.h).</li>
<li>Insert documentation blocks for all top-level entities (file, class, enum, struct, union, typedef, defines) and add them to the correct group. This must be done for each top-level entity.</li>
<li>Document function arguments only when necessary (speaking names).</li>
<li>Comments for base class functions must not be replicated in the derived class.</li>
<li>Start sentences with capital letters (correct orthography!).</li>
</ul>
</p>

<a name="header"></a>
<h3>Format for Header Files</h3>

<p>
<li>File extension is '<code>.h</code>'</li>
<li>Filename same as classname (ClassName.h)</li>
<li>Add an enclosing namespace to all declarations and definitions, e.g.
<pre class="snippet">
namespace av
{
  ...
}
</pre>
</li>
<li>Virtual functions are only explicitly declared as such at the introduction in the base class <code>virtual f();</code></li>
<li>Inherited virtual functions are commented to be virtual: <code>/* virtual */ f();</code></li>
<li>Avoid using inline functions (exceptions for template functions)</li>
<li>Prototype: <a href="../doxygen/styleguide.h.expl">styleguide.h.expl</a></li>
<li>Specify default parameters only in header file, don't repeat them in implementation (nor commented out)</li>
</ul>
</p>

<a name="implementation"></a>
<h3>Format for Implementation Files</h3>

<p>
<ul>
<li>File extension is '<code>.cpp</code>'</li>
<li>Filename same as classname (ClassName.cpp)</li>
<li>Make everything top-level (no enclosing namespace)</li>
<li>Break apart return value from function name and add commented additional specifiers (<code>static</code>, <code>virtual</code>)
<pre class="snippet">
/* virtual */ void
doSomeThing(int param1, int param2)
{}

/* static */ int
someClassFunction()
{}
</pre>
</li>
<li>Prototype: <a href="../doxygen/styleguide.cpp.expl">styleguide.cpp.expl</a></li>
</ul>
</p>

<a name="subversion"></a>
<h3>Subversion Guidelines</h3>

<p>
<ul><li>Use correct <a href="http://www.iana.org/assignments/media-types"> MIME</a> Media Types (especially for binaries), e.g.
<pre class="snippet">
% svn propset svn:mime-type "application/pdf" some.pdf
</pre>
</li>
<li>Auto-props are used to set properties on newly added files based on their filenames. Functionality can be configured by setting options in <code>~/.subversion/config</code>. All entries which match will be applied to the file. Prototype:
<pre class="snippet">
[miscellany]
enable-auto-props = yes

*.c = svn:eol-style=native
*.c++ = svn:eol-style=native
*.cpp = svn:eol-style=native
*.gif = svn:mime-type=image/gif
*.h = svn:eol-style=native
*.html = svn:eol-style=native;svn:mime-type=text/html
*.ico = svn:mime-type=image/x-ico
*.jpg = svn:mime-type=image/jpeg
*.m4 = svn:eol-style=native
*.ml = svn:eol-style=native
*.mli = svn:eol-style=native
*.pdf = svn:mime-type=application/pdf
*.png = svn:mime-type=image/png
*.py = svn:eol-style=native
*.rgb = svn:mime-type=image/x-rgb
*.scm = svn:eol-style=native
*.sln = svn:eol-style=native
*.sgi = svn:mime-type=image/x-sgi
*.sgm = svn:eol-style=native;svn:mime-type=text/sgml
*.sh = svn:eol-style=native;svn:executable
*.tif = svn:mime-type=image/tiff
*.txt = svn:eol-style=native
*.TXT = svn:eol-style=native
bootstrap = svn:eol-style=native;svn:executable
Makefile* = svn:eol-style=native
SConscript = svn:eol-style=native
SConstruct = svn:eol-style=native
</pre>
</li>
</ul>
</p>

<a name="references"></a>
<h3>References</h3>

<p>
<li><a href="http://www.scons.org/">SCons: Software construction tool</a></li>
<li><a href="http://www.doxygen.org/">Doxygen: Source code documentation generator tool</a></li>
<li><a href="http://epydoc.sourceforge.net/">Epydoc: Automatic API Documentation Generation for Python</a></li>
<li><a href="http://docutils.sourceforge.net/rst.html">reStructuredText: What-you-see-is-what-you-get plaintext markup syntax</a></li>
<li><a href="http://subversion.tigris.org/">Subversion: Version control system</a></li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2005/n1836.pdf">C++ TR1 Draft</a></li>
<li><a href="http://www.boost.org/">Boost: Portable C++ source libraries</a></li>
<li><a href="http://unittest-cpp.sourceforge.net/">UnitTest++: Lightweight unit testing framework for C++</a></li>
<li><a href="http://www.openscenegraph.org/">OpenSceneGraph: High performance 3D graphics toolkit</a></li>
<li><a href="http://www.openal.org/">OpenAL: Cross-platform 3D audio API</a></li>
<li><a href="http://dsl.cs.technion.ac.il/projects/Ensemble/">Ensemble: Distributed group Ccmmunication system</a></li>
</p>

<p>
<a href="../index.html">Back to main page</a>
</p>
<!-- End page contents -->

</body>
</html>



